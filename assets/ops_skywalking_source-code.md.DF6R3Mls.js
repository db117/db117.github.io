import{_ as p,c as e,o as l,ah as a,j as s}from"./chunks/framework.Zxa0uMAo.js";const m=JSON.parse('{"title":"源码分析","description":"","frontmatter":{"title":"源码分析"},"headers":[],"relativePath":"ops/skywalking/source-code.md","filePath":"ops/skywalking/source-code.md"}'),t={name:"ops/skywalking/source-code.md"};function i(r,n,c,o,g,u){return l(),e("div",null,[...n[0]||(n[0]=[a(`<h3 id="oap-server" tabindex="-1">oap server <a class="header-anchor" href="#oap-server" aria-label="Permalink to &quot;oap server&quot;">​</a></h3><blockquote><p><a href="https://github.com/apache/skywalking" target="_blank" rel="noreferrer">apache/skywalking: APM, Application Performance Monitoring System (github.com)</a></p><p><a href="https://skywalking.apache.org/" target="_blank" rel="noreferrer">Apache SkyWalking</a></p><p>服务端主流程源码分析。</p></blockquote><h4 id="目录结构" tabindex="-1">目录结构 <a class="header-anchor" href="#目录结构" aria-label="Permalink to &quot;目录结构&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>oap-server</span></span>
<span class="line"><span>├── analyzer									数据分析模块</span></span>
<span class="line"><span>│   ├── agent-analyzer				分析客户端发送的jvm，指标，trace 数据</span></span>
<span class="line"><span>│   ├── event-analyzer				分析事件</span></span>
<span class="line"><span>│   ├── log-analyzer					分析日志</span></span>
<span class="line"><span>│   ├── meter-analyzer				分析特定指标</span></span>
<span class="line"><span>│   └── pom.xml</span></span>
<span class="line"><span>├── exporter</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   └── src</span></span>
<span class="line"><span>├── microbench								基准测试</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   └── src</span></span>
<span class="line"><span>├── oal-grammar								oal 相关</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   └── src</span></span>
<span class="line"><span>├── oal-rt</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   └── src</span></span>
<span class="line"><span>├── pom.xml</span></span>
<span class="line"><span>├── server-alarm-plugin				告警插件</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   └── src</span></span>
<span class="line"><span>├── server-cluster-plugin			集群相关</span></span>
<span class="line"><span>│   ├── cluster-consul-plugin</span></span>
<span class="line"><span>│   ├── cluster-etcd-plugin</span></span>
<span class="line"><span>│   ├── cluster-kubernetes-plugin</span></span>
<span class="line"><span>│   ├── cluster-nacos-plugin</span></span>
<span class="line"><span>│   ├── cluster-standalone-plugin</span></span>
<span class="line"><span>│   ├── cluster-zookeeper-plugin</span></span>
<span class="line"><span>│   └── pom.xml</span></span>
<span class="line"><span>├── server-configuration			动态配置相关</span></span>
<span class="line"><span>│   ├── configuration-api</span></span>
<span class="line"><span>│   ├── configuration-apollo</span></span>
<span class="line"><span>│   ├── configuration-consul</span></span>
<span class="line"><span>│   ├── configuration-etcd</span></span>
<span class="line"><span>│   ├── configuration-k8s-configmap</span></span>
<span class="line"><span>│   ├── configuration-nacos</span></span>
<span class="line"><span>│   ├── configuration-zookeeper</span></span>
<span class="line"><span>│   ├── grpc-configuration-sync</span></span>
<span class="line"><span>│   └── pom.xml</span></span>
<span class="line"><span>├── server-core								核心模块</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   └── src</span></span>
<span class="line"><span>├── server-fetcher-plugin			数据接收模块，可以从别的地方获取数据</span></span>
<span class="line"><span>│   ├── kafka-fetcher-plugin</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   └── prometheus-fetcher-plugin</span></span>
<span class="line"><span>├── server-health-checker			健康检查</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   └── src</span></span>
<span class="line"><span>├── server-library						</span></span>
<span class="line"><span>│   ├── library-client									各种客户端</span></span>
<span class="line"><span>│   ├── library-datacarrier-queue				一个数据队列</span></span>
<span class="line"><span>│   ├── library-elasticsearch-client		es 客户端</span></span>
<span class="line"><span>│   ├── library-module									module 核心模块</span></span>
<span class="line"><span>│   ├── library-server									jetty 服务，grpc 服务</span></span>
<span class="line"><span>│   ├── library-util										各种工具类</span></span>
<span class="line"><span>│   └── pom.xml</span></span>
<span class="line"><span>├── server-query-plugin</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   └── query-graphql-plugin						前端 ui graphql查询接口</span></span>
<span class="line"><span>├── server-receiver-plugin							各种接收数据</span></span>
<span class="line"><span>│   ├── configuration-discovery-receiver-plugin</span></span>
<span class="line"><span>│   ├── envoy-metrics-receiver-plugin</span></span>
<span class="line"><span>│   ├── otel-receiver-plugin</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   ├── receiver-proto</span></span>
<span class="line"><span>│   ├── skywalking-browser-receiver-plugin</span></span>
<span class="line"><span>│   ├── skywalking-clr-receiver-plugin</span></span>
<span class="line"><span>│   ├── skywalking-ebpf-receiver-plugin</span></span>
<span class="line"><span>│   ├── skywalking-event-receiver-plugin</span></span>
<span class="line"><span>│   ├── skywalking-jvm-receiver-plugin</span></span>
<span class="line"><span>│   ├── skywalking-log-recevier-plugin</span></span>
<span class="line"><span>│   ├── skywalking-management-receiver-plugin</span></span>
<span class="line"><span>│   ├── skywalking-mesh-receiver-plugin</span></span>
<span class="line"><span>│   ├── skywalking-meter-receiver-plugin</span></span>
<span class="line"><span>│   ├── skywalking-profile-receiver-plugin</span></span>
<span class="line"><span>│   ├── skywalking-sharing-server-plugin</span></span>
<span class="line"><span>│   ├── skywalking-trace-receiver-plugin</span></span>
<span class="line"><span>│   ├── skywalking-zabbix-receiver-plugin</span></span>
<span class="line"><span>│   └── zipkin-receiver-plugin</span></span>
<span class="line"><span>├── server-starter										启动类</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   └── src</span></span>
<span class="line"><span>├── server-storage-plugin							数据存储模块</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   ├── storage-elasticsearch-plugin</span></span>
<span class="line"><span>│   ├── storage-influxdb-plugin</span></span>
<span class="line"><span>│   ├── storage-iotdb-plugin</span></span>
<span class="line"><span>│   ├── storage-jdbc-hikaricp-plugin</span></span>
<span class="line"><span>│   ├── storage-tidb-plugin</span></span>
<span class="line"><span>│   └── storage-zipkin-elasticsearch-plugin</span></span>
<span class="line"><span>├── server-telemetry</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   ├── telemetry-api</span></span>
<span class="line"><span>│   └── telemetry-prometheus</span></span>
<span class="line"><span>├── server-testing</span></span>
<span class="line"><span>│   ├── pom.xml</span></span>
<span class="line"><span>│   ├── server-testing.iml</span></span>
<span class="line"><span>│   └── src</span></span>
<span class="line"><span>└── server-tools</span></span>
<span class="line"><span>    ├── pom.xml</span></span>
<span class="line"><span>    └── profile-exporter</span></span></code></pre></div><h5 id="主要类以及接口" tabindex="-1">主要类以及接口 <a class="header-anchor" href="#主要类以及接口" aria-label="Permalink to &quot;主要类以及接口&quot;">​</a></h5><ul><li>OAPServerStartUp：启动类</li><li>ApplicationConfigLoader：加载配置</li><li>ModuleManager：加载各种模块</li><li>ModuleProvider：提供服务类，主要通过 <code>prepare</code>，<code>start</code>，<code>notifyAfterCompleted</code>实现各种个功能</li><li>ModuleConfig：各种插件配置类</li><li>ISource：数据对象</li><li>GRPCHandlerRegister：GRPC 处理器注册</li><li>JettyHandlerRegister：jetty 处理器注册</li></ul><h3 id="java-agent" tabindex="-1">Java agent <a class="header-anchor" href="#java-agent" aria-label="Permalink to &quot;Java agent&quot;">​</a></h3><blockquote><p>Java 客户端,搜集各种数据发送到服务端。</p><p><a href="https://github.com/apache/skywalking-java" target="_blank" rel="noreferrer">apache/skywalking-java: The Java agent for Apache SkyWalking (github.com)</a></p></blockquote><h4 id="目录结构-1" tabindex="-1">目录结构 <a class="header-anchor" href="#目录结构-1" aria-label="Permalink to &quot;目录结构&quot;">​</a></h4><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>.</span></span>
<span class="line"><span>├── apm-application-toolkit  				一些工具类，仅仅是接口，具体实现在 apm-toolkit-activation 中</span></span>
<span class="line"><span>├── apm-protocol										Protocol协议定义了各种数据格式，以及通信格式等</span></span>
<span class="line"><span>├── apm-sniffer											核心代码</span></span>
<span class="line"><span>│   ├── apm-agent										插件入口</span></span>
<span class="line"><span>│   ├── apm-agent-core							核心代码</span></span>
<span class="line"><span>│   ├── apm-sdk-plugin							所有插件的父项目，以及大部分插件</span></span>
<span class="line"><span>│   ├── apm-test-tools							</span></span>
<span class="line"><span>│   ├── apm-toolkit-activation			apm-application-toolkit 的具体实现</span></span>
<span class="line"><span>│   ├── bootstrap-plugins</span></span>
<span class="line"><span>│   ├── config</span></span>
<span class="line"><span>│   ├── optional-plugins</span></span>
<span class="line"><span>│   ├── optional-reporter-plugins</span></span>
<span class="line"><span>├── changes													变更记录</span></span>
<span class="line"><span>├── docs														文档</span></span></code></pre></div><h4 id="流程图" tabindex="-1">流程图 <a class="header-anchor" href="#流程图" aria-label="Permalink to &quot;流程图&quot;">​</a></h4>`,11),s("iframe",{id:"embed_dom",name:"embed_dom",frameborder:"0",style:{display:"block",width:"725px",height:"300px"},src:"https://www.processon.com/embed/6607d19db054b600d77a16da"},null,-1),s("iframe",{id:"embed_dom",name:"embed_dom",frameborder:"0",style:{display:"block",width:"725px",height:"300px"},src:"https://www.processon.com/embed/6607b8e498e2b2744ccaf997"},null,-1),a('<h4 id="主要类" tabindex="-1">主要类 <a class="header-anchor" href="#主要类" aria-label="Permalink to &quot;主要类&quot;">​</a></h4><ul><li>SkyWalkingAgent：启动类</li><li>Config：所有配置都在这个类中。</li><li>BootService：所有服务的顶级接口</li><li>TracingContext：核心类，主要用来创建 span</li><li>GlobalIdGenerator：生成 <code>traceId</code> ，第一部分为<code>实例 id</code>，第二部分为<code>线程 id</code>，第三部分为时间戳（毫秒）+当前线程中的序列号[0,9999]</li><li>AbstractSpan：各种插件使用</li></ul><h2 id="" tabindex="-1"><a class="header-anchor" href="#" aria-label="Permalink to &quot;&quot;">​</a></h2>',3)])])}const h=p(t,[["render",i]]);export{m as __pageData,h as default};
