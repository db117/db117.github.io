import{_ as e,c as a,o as i,a7 as t}from"./chunks/framework.DlLVvJYm.js";const m=JSON.parse('{"title":"Mysql批量插入数据","description":"","frontmatter":{"title":"Mysql批量插入数据"},"headers":[],"relativePath":"database/mysql/Mysql批量插入数据.md","filePath":"database/mysql/Mysql批量插入数据.md","lastUpdated":1715260831000}'),l={name:"database/mysql/Mysql批量插入数据.md"},o=t(`<h1 id="insert-ignore-into" tabindex="-1">insert ignore into <a class="header-anchor" href="#insert-ignore-into" aria-label="Permalink to &quot;insert ignore into&quot;">​</a></h1><h3 id="作用" tabindex="-1">作用 <a class="header-anchor" href="#作用" aria-label="Permalink to &quot;作用&quot;">​</a></h3><ul><li><code>insert ignore</code> 会根据主键或者唯一键判断，忽略数据库中已经存在的数据</li><li>若数据库没有该条数据，就插入为新的数据，跟普通的 <code>insert into</code> 一样</li><li>若数据库有该条数据，就忽略这条插入语句，不执行插入操作。</li></ul><h3 id="主键冲突情况" tabindex="-1">主键冲突情况 <a class="header-anchor" href="#主键冲突情况" aria-label="Permalink to &quot;主键冲突情况&quot;">​</a></h3><ol><li><h4 id="同时向表中插入两条包含主键的数据" tabindex="-1">同时向表中插入两条包含主键的数据 <a class="header-anchor" href="#同时向表中插入两条包含主键的数据" aria-label="Permalink to &quot;同时向表中插入两条包含主键的数据&quot;">​</a></h4><blockquote><p>insert ignore into 与普通 insert into 的使用方法几乎完全一样 插入时要么指定插入的具体列，要么不指定列名插入全部列值，要么对字段加有默认值 否则会报错：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>ERROR 1136 (21S01): Column count doesn&#39;t match value count at row 1</span></span>
<span class="line"><span>   或 ERROR 1364 (HY000): Field &#39;title&#39; doesn&#39;t have a default value</span></span></code></pre></div></blockquote></li></ol><h3 id="唯一键冲突情况" tabindex="-1">唯一键冲突情况 <a class="header-anchor" href="#唯一键冲突情况" aria-label="Permalink to &quot;唯一键冲突情况&quot;">​</a></h3><p>​ 数据不会发生变化但是自增主键会加1</p><h2 id="insert-into-on-duplicate-key-update" tabindex="-1">insert into ... on duplicate key update <a class="header-anchor" href="#insert-into-on-duplicate-key-update" aria-label="Permalink to &quot;insert into ... on duplicate key update&quot;">​</a></h2><h3 id="作用-1" tabindex="-1">作用 <a class="header-anchor" href="#作用-1" aria-label="Permalink to &quot;作用&quot;">​</a></h3><ul><li>在<code>insert into</code>语句末尾指定<code>on duplicate key update</code>，会根据主键或者唯一键判断： <ul><li>若数据库有该条数据，则直接更新原数据，相当于 <code>update</code></li><li>若数据库没有该条数据，则插入为新的数据，跟普通的 <code>insert into</code> 一样</li></ul></li></ul><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>insert into table_name(field_name...) values (value...), (value...) on duplicate key update field_name=values(field_name), field_name=field_name;</span></span></code></pre></div><ol><li><p>与普通<code>insert into</code>的使用语法差别不大，只是语句结尾有所区别</p></li><li><p><code>field_name=values(field_name)</code></p><p><strong>使用的是插入的字段值</strong></p><p>表示当存在主键或唯一键冲突时，使用插入语句中对应的 emp_no 和 title 值替换原数据</p></li><li><p><code>field_name=field_name</code></p><p><strong>使用的是原的字段值</strong></p><p>同时，还可以通过运算表达式来指定字段值，如：field_name=field_name+1, field_name=field_name+&quot;test&quot;</p></li><li><p><code>field_name=value</code></p><p>直接设置值</p></li><li><p>为设置更新字段不进行更新</p></li><li><p>如果是插入操作，受到影响行的值为1；如果更新操作，受到影响行的值为2；如果更新的数据和已有的数据一样</p></li></ol><h2 id="replace-into" tabindex="-1">replace into <a class="header-anchor" href="#replace-into" aria-label="Permalink to &quot;replace into&quot;">​</a></h2><h3 id="作用-2" tabindex="-1">作用 <a class="header-anchor" href="#作用-2" aria-label="Permalink to &quot;作用&quot;">​</a></h3><ul><li><code>replace into</code> 会根据主键或者唯一键判断：</li><li>若表中已存在该数据，则先删除此行数据，然后插入新的数据，相当于 <code>delete + insert</code></li><li>若表中不存在该数据，则直接插入新数据，跟普通的 <code>insert into</code> 一样</li><li>在存在多个唯一索引,或者高并发情况下不建议使用(可能发生死锁)</li></ul>`,15),n=[o];function s(d,r,c,p,u,h){return i(),a("div",null,n)}const b=e(l,[["render",s]]);export{m as __pageData,b as default};
