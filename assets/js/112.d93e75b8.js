(window.webpackJsonp=window.webpackJsonp||[]).push([[112],{515:function(e,s,a){"use strict";a.r(s);var t=a(34),n=Object(t.a)({},(function(){var e=this,s=e.$createElement,a=e._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h2",{attrs:{id:"linux安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#linux安装"}},[e._v("#")]),e._v(" linux安装")]),e._v(" "),a("ul",[a("li",[e._v("下载\n"),a("ul",[a("li",[e._v("最新版本")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('curl -LO "https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/linux/amd64/kubectl"\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])]),a("ul",[a("li",[e._v("指定版本")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("curl -LO https://dl.k8s.io/release/v1.20.0/bin/linux/amd64/kubectl\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])]),e._v(" "),a("li",[e._v("安装"),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("  sudo install -o root -g root -m 0755 kubectl /usr/local/bin/kubectl\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])]),e._v(" "),a("li",[e._v("配置")])]),e._v(" "),a("blockquote",[a("p",[e._v("配置文件位置 ~/kube/config")])]),e._v(" "),a("h2",{attrs:{id:"常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用命令"}},[e._v("#")]),e._v(" 常用命令")]),e._v(" "),a("h3",{attrs:{id:"pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod"}},[e._v("#")]),e._v(" pod")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("重启")]),e._v(" "),a("ol",[a("li",[a("p",[e._v("强制替换Pod")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl replace --force -f xxxx.yaml\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])]),e._v(" "),a("li",[a("p",[e._v("调整副本来重启")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl scale deployment {deployment} --replicas=0 -n {namespace}\nkubectl scale deployment {deployment} --replicas=1 -n {namespace}\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br")])])]),e._v(" "),a("li",[a("p",[e._v("直接删除")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl delete pod {podname} -n {namespace}\n\nkubectl delete replicaset {rs_name} -n {namespace}\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])])]),e._v(" "),a("li",[a("p",[e._v("没有 yaml 文件，直接使用的 Pod 对象")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl get pod {podname} -n {namespace} -o yaml | kubectl replace --force -f -\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])])])])]),e._v(" "),a("h3",{attrs:{id:"命名空间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#命名空间"}},[e._v("#")]),e._v(" 命名空间")]),e._v(" "),a("ul",[a("li",[a("p",[e._v("创建命名空间")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl create namespace test-env \n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])]),e._v(" "),a("li",[a("p",[e._v("设置默认命名空间")]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl config set-context default --namespace=${work_namespace}\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])])]),e._v(" "),a("h3",{attrs:{id:"secret"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#secret"}},[e._v("#")]),e._v(" Secret")]),e._v(" "),a("blockquote",[a("p",[e._v("创建docker访问secret\n需要在Deployment中指定")])]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("kubectl create secret docker-registry my-secret --docker-server=DOCKER_REGISTRY_SERVER --docker-username=DOCKER_USER --docker-password=DOCKER_PASSWORD --docker-email=DOCKER_EMAIL\n")])])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("spec:\n  imagePullSecrets:\n  - name: my-secret\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br")])]),a("h3",{attrs:{id:"污点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#污点"}},[e._v("#")]),e._v(" 污点")]),e._v(" "),a("ul",[a("li",[a("p",[a("strong",[e._v("打上污点")])]),e._v(" "),a("blockquote",[a("p",[e._v("NoSchedule:"),a("a",{attrs:{href:"https://www.iyunw.cn/archives/tag/k8s/",target:"_blank",rel:"noopener noreferrer"}},[e._v("K8S"),a("OutboundLink")],1),e._v("node添加这个effecf类型污点，新的不能容忍的pod不能再调度过来，但是老的运行在node上不受影响")]),e._v(" "),a("p",[e._v("NoExecute：K8Snode添加这个effecf类型污点，新的不能容忍的pod不能调度过来，老的pod也会被驱逐")]),e._v(" "),a("p",[e._v("PreferNoSchedule：pod会尝试将pod分配到该节点")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl taint nodes node1 key=value:NoSchedule\n\nkubectl taint nodes node1 key=value:NoExecute\n\nkubectl taint nodes node1 key=value:PreferNoSchedule\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])])]),e._v(" "),a("li",[a("p",[a("strong",[e._v("删除污点")])]),e._v(" "),a("ul",[a("li",[a("blockquote",[a("p",[e._v("加上[-]")])])])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("  kubectl taint nodes node1 key=value:NoSchedule-\n\n  kubectl taint nodes node1 key=value:NoExecute-\n\n  kubectl taint nodes node1 key=value:PreferNoSchedule-\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br")])]),a("h5",{attrs:{id:"pod设置容忍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod设置容忍"}},[e._v("#")]),e._v(" "),a("strong",[e._v("pod设置容忍")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('tolerations:  #containers同级\n    - key: "key1"          #能容忍的污点key\n      operator: "Equal"    #Equal等于表示key=value ， Exists不等于，表示当值不等于下面value正常\n      value: "value1"      #值\n      effect: "NoExecute"  #effect策略，见上面\n      tolerationSeconds: 3600  #原始的pod多久驱逐，注意只有effect: "NoExecute"才能设置，不然报错\n')])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br"),a("span",{staticClass:"line-number"},[e._v("2")]),a("br"),a("span",{staticClass:"line-number"},[e._v("3")]),a("br"),a("span",{staticClass:"line-number"},[e._v("4")]),a("br"),a("span",{staticClass:"line-number"},[e._v("5")]),a("br"),a("span",{staticClass:"line-number"},[e._v("6")]),a("br")])])])]),e._v(" "),a("h3",{attrs:{id:"查询配置文件结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查询配置文件结构"}},[e._v("#")]),e._v(" 查询配置文件结构")]),e._v(" "),a("blockquote",[a("p",[e._v("不清楚某些配置文件怎么配置的情况下使用")])]),e._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("kubectl explain ServiceMonitor.spec.endpoints\n")])]),e._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[e._v("1")]),a("br")])])])}),[],!1,null,null,null);s.default=n.exports}}]);