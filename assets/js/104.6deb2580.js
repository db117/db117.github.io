(window.webpackJsonp=window.webpackJsonp||[]).push([[104],{475:function(t,e,s){"use strict";s.r(e);var n=s(28),a=Object(n.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"nginx配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx配置"}},[t._v("#")]),t._v(" Nginx配置")]),t._v(" "),s("h2",{attrs:{id:"核心配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#核心配置"}},[t._v("#")]),t._v(" 核心配置")]),t._v(" "),s("h3",{attrs:{id:"文件结构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#文件结构"}},[t._v("#")]),t._v(" 文件结构")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("main")]),t._v(" 全局配置，对全局生效；")]),t._v(" "),s("li",[s("code",[t._v("events")]),t._v(" 配置影响 "),s("code",[t._v("Nginx")]),t._v(" 服务器与用户的网络连接；")]),t._v(" "),s("li",[s("code",[t._v("http")]),t._v(" 配置代理，缓存，日志定义等绝大多数功能和第三方模块的配置；")]),t._v(" "),s("li",[s("code",[t._v("server")]),t._v(" 配置虚拟主机的相关参数，一个 "),s("code",[t._v("http")]),t._v(" 块中可以有多个 "),s("code",[t._v("server")]),t._v(" 块；")]),t._v(" "),s("li",[s("code",[t._v("location")]),t._v(" 用于配置匹配的 "),s("code",[t._v("uri")]),t._v(" ；")]),t._v(" "),s("li",[s("code",[t._v("upstream")]),t._v(" 配置后端服务器具体地址，负载均衡配置不可或缺的部分；")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('# main段配置信息\nuser  nginx;                        \t\t\t\t# 运行用户，默认即是nginx，可以不进行设置\ndaemon off; \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t# 默认是on，后台运行模式\nworker_processes  auto;             \t\t\t\t# Nginx 进程数，一般设置为和 CPU 核数一样\nworker_cpu_affinity 0001 0010 0100 1000; \t\t# 4个物理核心，4个worker子进程复制代码\npid        /var/run/nginx.pid;      \t\t\t\t# Nginx 服务启动时的 pid 存放位置\nworker_rlimit_nofile 20480; \t\t\t\t\t\t\t\t# 可以理解成每个worker子进程的最大连接数量。\nworker_priority -10; \t\t\t\t\t\t\t\t\t\t\t\t# 120-10=110，110就是最终的优先级\n\nworker_shutdown_timeout 5s;\t\t\t\t\t\t\t\t\t# 指定 worker 子进程优雅退出时的超时时间。\n\nerror_log  /var/log/nginx/error.log warn;   # Nginx 的错误日志存放目录\n\n\n# events段配置信息\nevents {\n    use epoll;     \t\t\t\t\t\t\t# 使用epoll的I/O模型(如果你不知道Nginx该使用哪种轮询方法，会自动选择一个最适合你操作系统的)\n    worker_connections 1024;   \t# 每个进程允许最大并发数\n    accept_mutex on;\t\t\t\t\t\t# 是否打开负载均衡互斥锁,默认是off关闭的\n}\n\n# http段配置信息\n# 配置使用最频繁的部分，代理、缓存、日志定义等绝大多数功能和第三方模块的配置都在这里设置\nhttp {\n    # 设置日志模式\n    log_format  main  \'$remote_addr - $remote_user [$time_local] "$request" \'\n                      \'$status $body_bytes_sent "$http_referer" \'\n                      \'"$http_user_agent" "$http_x_forwarded_for"\';\n\n    access_log  /var/log/nginx/access.log  main;   # Nginx访问日志存放位置\n\n    sendfile            on;   # 开启高效传输模式\n    tcp_nopush          on;   # 减少网络报文段的数量\n    tcp_nodelay         on;\n    keepalive_timeout   65;   # 保持连接的时间，也叫超时时间，单位秒\n    types_hash_max_size 2048; # 散列表大小,默认1024\n\n    include             /etc/nginx/mime.types;      # 文件扩展名与类型映射表\n    default_type        application/octet-stream;   # 默认文件类型\n\n    include /etc/nginx/conf.d/*.conf;   # 加载子配置项\n\n    # server段配置信息\n    server {\n     listen       80;       \t\t# 配置监听的端口\n     server_name  localhost;    # 配置的域名\n\n     # location段配置信息\n     location / {\n      root   /usr/share/nginx/html;  \t# 网站根目录\n      index  index.html index.htm;   \t# 默认首页文件\n      deny 172.168.22.11;   \t\t\t\t\t# 禁止访问的ip地址，可以为all\n      allow 172.168.33.44；\t\t\t\t\t  # 允许访问的ip地址，可以为all\n     }\n\n     error_page 500 502 503 504 /50x.html;  # 默认50x对应的访问页面\n     error_page 400 404 error.html;   \t\t\t# 同上\n    }\n}\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br"),s("span",{staticClass:"line-number"},[t._v("34")]),s("br"),s("span",{staticClass:"line-number"},[t._v("35")]),s("br"),s("span",{staticClass:"line-number"},[t._v("36")]),s("br"),s("span",{staticClass:"line-number"},[t._v("37")]),s("br"),s("span",{staticClass:"line-number"},[t._v("38")]),s("br"),s("span",{staticClass:"line-number"},[t._v("39")]),s("br"),s("span",{staticClass:"line-number"},[t._v("40")]),s("br"),s("span",{staticClass:"line-number"},[t._v("41")]),s("br"),s("span",{staticClass:"line-number"},[t._v("42")]),s("br"),s("span",{staticClass:"line-number"},[t._v("43")]),s("br"),s("span",{staticClass:"line-number"},[t._v("44")]),s("br"),s("span",{staticClass:"line-number"},[t._v("45")]),s("br"),s("span",{staticClass:"line-number"},[t._v("46")]),s("br"),s("span",{staticClass:"line-number"},[t._v("47")]),s("br"),s("span",{staticClass:"line-number"},[t._v("48")]),s("br"),s("span",{staticClass:"line-number"},[t._v("49")]),s("br"),s("span",{staticClass:"line-number"},[t._v("50")]),s("br"),s("span",{staticClass:"line-number"},[t._v("51")]),s("br"),s("span",{staticClass:"line-number"},[t._v("52")]),s("br"),s("span",{staticClass:"line-number"},[t._v("53")]),s("br"),s("span",{staticClass:"line-number"},[t._v("54")]),s("br"),s("span",{staticClass:"line-number"},[t._v("55")]),s("br"),s("span",{staticClass:"line-number"},[t._v("56")]),s("br"),s("span",{staticClass:"line-number"},[t._v("57")]),s("br"),s("span",{staticClass:"line-number"},[t._v("58")]),s("br"),s("span",{staticClass:"line-number"},[t._v("59")]),s("br")])]),s("h3",{attrs:{id:"常用变量"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用变量"}},[t._v("#")]),t._v(" 常用变量")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",{staticStyle:{"text-align":"left"}},[t._v("变量名")]),t._v(" "),s("th",{staticStyle:{"text-align":"left"}},[t._v("含义")])])]),t._v(" "),s("tbody",[s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("remote_addr")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("客户端 "),s("code",[t._v("IP")]),t._v(" 地址")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("remote_port")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("客户端端口")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("server_addr")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("服务端 "),s("code",[t._v("IP")]),t._v(" 地址")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("server_port")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("服务端端口")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("server_protocol")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("服务端协议")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("binary_remote_addr")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("二进制格式的客户端 "),s("code",[t._v("IP")]),t._v(" 地址")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("connection")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("TCP")]),t._v(" 连接的序号，递增")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("connection_request")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("TCP")]),t._v(" 连接当前的请求数量")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("uri")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("请求的URL，不包含参数")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("request_uri")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("请求的URL，包含参数")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("scheme")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("协议名， "),s("code",[t._v("http")]),t._v(" 或 "),s("code",[t._v("https")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("request_method")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("请求方法")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("request_length")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("全部请求的长度，包含请求行、请求头、请求体")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("args")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("全部参数字符串")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("arg_参数名")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("获取特定参数值")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("is_args")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("URL")]),t._v(" 中是否有参数，有的话返回 "),s("code",[t._v("?")]),t._v(" ，否则返回空")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("query_string")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("与 "),s("code",[t._v("args")]),t._v(" 相同")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("host")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("请求信息中的 "),s("code",[t._v("Host")]),t._v(" ，如果请求中没有 "),s("code",[t._v("Host")]),t._v(" 行，则在请求头中找，最后使用 "),s("code",[t._v("nginx")]),t._v(" 中设置的 "),s("code",[t._v("server_name")]),t._v(" 。")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http_user_agent")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("用户浏览器")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http_referer")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("从哪些链接过来的请求")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http_via")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("每经过一层代理服务器，都会添加相应的信息")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("http_cookie")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("获取用户 "),s("code",[t._v("cookie")])])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("request_time")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("处理请求已消耗的时间")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("https")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("是否开启了 "),s("code",[t._v("https")]),t._v(" ，是则返回 "),s("code",[t._v("on")]),t._v(" ，否则返回空")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("request_filename")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("磁盘文件系统待访问文件的完整路径")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("document_root")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("由 "),s("code",[t._v("URI")]),t._v(" 和 "),s("code",[t._v("root/alias")]),t._v(" 规则生成的文件夹路径")])]),t._v(" "),s("tr",[s("td",{staticStyle:{"text-align":"left"}},[s("code",[t._v("limit_rate")])]),t._v(" "),s("td",{staticStyle:{"text-align":"left"}},[t._v("返回响应时的速度上限值")])])])]),t._v(" "),s("p",[t._v("实例演示 "),s("code",[t._v("var.conf")]),t._v(" ：")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('server{\n listen 8081;\n server_name var.lion-test.club;\n root /usr/share/nginx/html;\n location / {\n  return 200 "\nremote_addr: $remote_addr\nremote_port: $remote_port\nserver_addr: $server_addr\nserver_port: $server_port\nserver_protocol: $server_protocol\nbinary_remote_addr: $binary_remote_addr\nconnection: $connection\nuri: $uri\nrequest_uri: $request_uri\nscheme: $scheme\nrequest_method: $request_method\nrequest_length: $request_length\nargs: $args\narg_pid: $arg_pid\nis_args: $is_args\nquery_string: $query_string\nhost: $host\nhttp_user_agent: $http_user_agent\nhttp_referer: $http_referer\nhttp_via: $http_via\nrequest_time: $request_time\nhttps: $https\nrequest_filename: $request_filename\ndocument_root: $document_root\n";\n }\n}\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br"),s("span",{staticClass:"line-number"},[t._v("21")]),s("br"),s("span",{staticClass:"line-number"},[t._v("22")]),s("br"),s("span",{staticClass:"line-number"},[t._v("23")]),s("br"),s("span",{staticClass:"line-number"},[t._v("24")]),s("br"),s("span",{staticClass:"line-number"},[t._v("25")]),s("br"),s("span",{staticClass:"line-number"},[t._v("26")]),s("br"),s("span",{staticClass:"line-number"},[t._v("27")]),s("br"),s("span",{staticClass:"line-number"},[t._v("28")]),s("br"),s("span",{staticClass:"line-number"},[t._v("29")]),s("br"),s("span",{staticClass:"line-number"},[t._v("30")]),s("br"),s("span",{staticClass:"line-number"},[t._v("31")]),s("br"),s("span",{staticClass:"line-number"},[t._v("32")]),s("br"),s("span",{staticClass:"line-number"},[t._v("33")]),s("br")])]),s("h2",{attrs:{id:"常用配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#常用配置"}},[t._v("#")]),t._v(" 常用配置")]),t._v(" "),s("h3",{attrs:{id:"负载均衡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#负载均衡"}},[t._v("#")]),t._v(" 负载均衡")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("server")]),t._v(" 定义上游服务器地址；")]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("语法：server address [parameters]\n\nparameters 可选值：\nweight=number 权重值，默认为1；\nmax_conns=number 上游服务器的最大并发连接数；\nfail_timeout=time 服务器不可用的判定时间；\nmax_fails=numer 服务器不可用的检查次数；\nbackup 备份服务器，仅当其他服务器都不可用时才会启用；\ndown 标记服务器长期不可用，离线维护；\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])])]),t._v(" "),s("li",[s("p",[s("code",[t._v("zone")]),t._v(" 定义共享内存，用于跨 "),s("code",[t._v("worker")]),t._v(" 子进程；")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("keepalive")]),t._v(" 对上游服务启用长连接；")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("keepalive_requests")]),t._v(" 一个长连接最多请求 "),s("code",[t._v("HTTP")]),t._v(" 的个数；默认1000")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("keepalive_timeout")]),t._v(" 空闲情形下，一个长连接的超时时长 默认60s")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("keepalive_time")]),t._v("一个连接最长时间 默认1h")])])]),t._v(" "),s("p",[t._v("负载均衡类型")]),t._v(" "),s("ul",[s("li",[s("p",[s("code",[t._v("hash")]),t._v(" 哈希负载均衡算法；")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("ip_hash")]),t._v(" 依据 "),s("code",[t._v("IP")]),t._v(" 进行哈希计算的负载均衡算法；")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("random")]),t._v(" 随机负载均衡算法；")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("least_conn")]),t._v(" 最少连接数负载均衡算法；")])]),t._v(" "),s("li",[s("p",[s("code",[t._v("least_time")]),t._v(" 最短响应时间负载均衡算法；")])])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("upstream dynamic {\n\t\thash $request_uri;\n\t\tleast_conn;\n\t\tip_hash;\n\t\tleast_conn;\n\t\t\n\t\t\n    zone upstream_dynamic 64k;\n\n    server backend1.example.com      weight=5;\n    server backend2.example.com:8080 fail_timeout=5s slow_start=30s;\n    server 192.0.2.1                 max_fails=3;\n    server backend3.example.com      resolve;\n    server backend4.example.com      service=http resolve;\n\n    server backup1.example.com:8080  backup;\n    server backup2.example.com:8080  backup;\n    \n    keepalive 32;\n}\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br"),s("span",{staticClass:"line-number"},[t._v("17")]),s("br"),s("span",{staticClass:"line-number"},[t._v("18")]),s("br"),s("span",{staticClass:"line-number"},[t._v("19")]),s("br"),s("span",{staticClass:"line-number"},[t._v("20")]),s("br")])]),s("h3",{attrs:{id:"proxy-pass"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#proxy-pass"}},[t._v("#")]),t._v(" proxy_pass")]),t._v(" "),s("blockquote",[s("p",[t._v("代理转发")])]),t._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v(' location / {\n      proxy_set_header        X-Real-IP       $remote_addr;\n      proxy_set_header        X-Forwarded-For $proxy_add_x_forwarded_for;\n      proxy_http_version 1.1;\n      proxy_set_header Connection "";\n      proxy_pass http://127.0.0.1:9400;\n    }\n')])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br")])])])}),[],!1,null,null,null);e.default=a.exports}}]);